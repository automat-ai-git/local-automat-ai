# Cloud-Local n8n & Flowise Setup

Автоматизированный установочный скрипт для n8n и Flowise с обратным прокси-сервером Caddy для безопасного доступа по HTTPS.

## Описание

Этот репозиторий содержит скрипты для автоматической настройки:

- **n8n** — мощной платформы для автоматизации рабочих процессов с открытым исходным кодом.
- **Flowise** — инструмента для создания настраиваемых AI-потоков.
- **Caddy** — современного веб-сервера с автоматическим HTTPS.
- **gpt2giga** — коннектора к GigaChat.
- **Qdrant and Postgres** — современных векторных хранилищ БД.
- **Ollama** — локального ollama с моделями.

Система настроена на работу с вашим доменным именем и автоматически получает SSL-сертификаты Let's Encrypt.

## Требования

- Ubuntu 22.04
- Доменное имя, указывающее на IP-адрес вашего сервера.
- Доступ к серверу с правами администратора (sudo).
- Открытые порты 80, 443.

## Установка

1.  Клонируйте репозиторий:
    ```bash
    git clone [https://github.com/automat-ai-git/local-automat-ai.git](https://github.com/automat-ai-git/local-automat-ai.git) && cd local-automat-ai
    ```
2.  Сделайте скрипт исполняемым:
    ```bash
    chmod +x setup.sh
    ```
3.  Запустите установочный скрипт:
    ```bash
    ./setup.sh
    ```
4.  Следуйте инструкциям в терминале:
    - Введите ваше доменное имя (например, example.com).
    - Введите ваш email (будет использоваться для входа в n8n и Let's Encrypt).

## Что делает установочный скрипт

1.  **Обновление системы**: обновляет список пакетов и устанавливает необходимые зависимости.
2.  **Установка Docker**: устанавливает Docker Engine и Docker Compose.
3.  **Настройка каталогов**: создает пользователя n8n и необходимые каталоги.
4.  **Генерация секретов**: создает случайные пароли и ключи шифрования.
5.  **Создание конфигурационных файлов**: генерирует файлы docker-compose и Caddyfile.
6.  **Настройка брандмауэра**: открывает необходимые порты.
7.  **Запуск служб**: запускает контейнеры Docker.

## Доступ к службам

После завершения установки вы сможете получить доступ к службам по следующим URL-адресам:

- **n8n**: https://n8n.your-domain.xxx
- **Flowise**: https://flowise.your-domain.xxx

> Данные для входа будут отображены в конце процесса установки.

## Структура проекта

- `setup.sh` — основной установочный скрипт.
- `setup-files/` — каталог со вспомогательными скриптами:
  - `01-update-system.sh` — обновление системы.
  - `02-install-docker.sh` — установка Docker.
  - `03-setup-directories.sh` — настройка каталогов и пользователя.
  - `04-generate-secrets.sh` — генерация секретных ключей.
  - `05-create-templates.sh` — создание конфигурационных файлов.
  - `06-setup-firewall.sh` — настройка брандмауэра.
  - `07-start-services.sh` — запуск служб.
- `n8n-docker-compose.yaml.template` — шаблон docker-compose для n8n и Caddy.
- `flowise-docker-compose.yaml.template` — шаблон docker-compose для Flowise, GigaChat и VectorDB`s Qdrant PostgresSQL.

## Управление службами

### Перезапуск служб

```bash
docker compose -f n8n-docker-compose.yaml restart
docker compose -f flowise-docker-compose.yaml restart
```

### Остановка служб

```bash
docker compose -f n8n-docker-compose.yaml down
docker compose -f flowise-docker-compose.yaml down
```

### Просмотр логов

```bash
docker compose -f n8n-docker-compose.yaml logs
docker compose -f flowise-docker-compose.yaml logs
```

## Безопасность

- Все службы доступны только по HTTPS с автоматически обновляемыми сертификатами Let's Encrypt.
- Для n8n и Flowise создаются случайные пароли.
- Пользователи создаются с минимально необходимыми привилегиями.

## Устранение неполадок

- Проверьте DNS-записи вашего домена, чтобы убедиться, что они указывают на правильный IP-адрес.
- Убедитесь, что на вашем сервере открыты порты 80 и 443.
- Просмотрите логи контейнеров, чтобы обнаружить ошибки.

## Лицензия

Этот проект распространяется под лицензией MIT License.

## Автор

automat-ai based on @codegeek


